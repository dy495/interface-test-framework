<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.haisheng.framework.dao.ICaseDao">
    <resultMap id="CaseMap" type="com.haisheng.framework.model.bean.Case">
        <result property="id" column="id"/>
        <result property="applicationId" column="application_id" />
        <result property="configId" column="config_id" />
        <result property="caseName" column="case_name" />
        <result property="caseDescription" column="case_description" />
        <result property="createTime" column="create_time" />
        <result property="editTime" column="edit_time" />
        <result property="result" column="result" />
        <result property="expect" column="expect" />
        <result property="response" column="response" />
        <result property="requestData" column="request_data" />
        <result property="authenticationInfo" column="authentication_info" />
        <result property="failReason" column="fail_reason" />
        <result property="qaOwner" column="qa_owner" />
        <result property="canManualRun" column="can_manual_run" />
        <result property="runByCi" column="run_by_ci" />
    </resultMap>

    <!-- 所有字段 -->
    <sql id="allFields">
        id,application_id,config_id,case_name,case_description,create_time,edit_time,result,expect,response,request_data,qa_owner,fail_reason,authentication_info,can_manual_run,run_by_ci
    </sql>


    <!-- insert application-->
    <insert id="insert"
            parameterType="com.haisheng.framework.model.bean.Case"
            useGeneratedKeys="true"
            keyProperty="id">
        <![CDATA[
            insert into t_case (
                id,
                application_id,
                config_id,
                case_name,
                expect,
                request_data,
                response,
                result,
                qa_owner,
                edit_time,
                can_manual_run,
                run_by_ci
            ) values (
                #{id},
                #{applicationId},
                #{configId},
                #{caseName},
                #{expect},
                #{requestData},
                #{response},
                #{result},
                #{qaOwner},
                #{editTime},
                #{canManualRun},
                #{runByCi}
            ) ON DUPLICATE KEY UPDATE
            request_data=#{requestData},
            response=#{response},
            expect=#{expect},
            result=#{result},
            edit_time=#{editTime},
            can_manual_run=#{canManualRun},
            run_by_ci=#{runByCi}
        ]]>
    </insert>

    <select id="queryCaseByName"
            resultType="java.lang.Integer">
        select
        id
        from
        t_case
        <where>
            application_id = #{applicationId}
            and config_id = #{configId}
            and case_name = #{caseName}
        </where>
    </select>
</mapper>